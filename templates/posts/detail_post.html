{% extends "base.html" %}
{% load static %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <div class="card mt-n4 mx-n4 mb-n5">
                <div class="bg-soft-warning">
                    <div class="card-body pb-4 mb-5">
                        <div class="row align-items-center">
                            <div class="col-md">
                                <h4 class="fw-semibold" id="ticket-title">{{ post.title }}</h4>
                                <div class="hstack gap-3 flex-wrap">
                                    <div class="text-muted">
                                        <span id="ticket-client">{{ post.post_type }}</span>
                                    </div>
                                    <div class="vr"></div>
                                    <div class="text-muted">
                                        Ngày tạo : <span class="fw-medium" id="create-date">{{ post.created_at|date:"M d, Y" }}
                                            <i class="mdi mdi-circle-medium align-middle mx-1"></i>
                                            {{ post.created_at|date:"H:i" }}</span>
                                    </div>
                                    <div class="vr"></div>
                                    <div class="text-muted">
                                        Lượt xem : <span class="fw-medium" id="create-date">{{ post.views }}</span>
                                    </div>
                                    <div class="vr"></div>
                                    <div class="social-share">
                                        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}"
                                            target="_blank" class="btn btn-primary">
                                            <i class="fab fa-facebook-f"></i> Share on Facebook
                                        </a>
                                        <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ post.post_type }}"
                                            target="_blank" class="btn btn-info">
                                            <i class="fab fa-twitter"></i> Share on Twitter
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xxl-9">
            <div class="card">
                <div class="card-body p-4">
                    <img style="height: 100px; width: 100%; object-fit: contain" class="rounded-start img-fluid h-100 object-cover" src="{{ post.image.url }}" alt="{{ post.title }}">
                    <h6 class="fw-semibold text-uppercase mb-3">{{ post.notes}}</h6>
                    {% comment %} {% for image in images %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}" data-bs-interval="10000">
                        <img style="height: 100px; width: 100%; object-fit: contain" src="{{ post.image.url }}" class="d-block w-100" alt="Image for {{ post.title }}" />
                    </div>
                    {% endfor %} {% endcomment %}
                    
                    <p>{{ post.content|safe }}</p>

                    {% if post.source_url %}
                    <p><strong>Nguồn:</strong> <a href="{{ post.source_url }}" target="_blank">{{ post.source_url }}</a></p>
                    {% endif %}
                </div>
                <!-- end card body -->
            </div>
            <!--end card-->
        </div>
        <!--end col-->
        <div class="col-xxl-3">
            <div class="card">
                <div class="card-header align-items-center d-flex">
                    <h4 class="card-title mb-0 flex-grow-1">Latest Post</h4>
                    <div>
                        <button type="button" class="btn btn-soft-primary btn-sm">
                            View all
                        </button>
                    </div>
                </div><!-- end card-header -->

                <div class="card-body">
                    {% for latest_post in latest_posts %}
                    <div class="d-flex mt-4">
                        <div class="flex-shrink-0">
                            <img src="{{ latest_post.image.url }}" class="rounded img-fluid" style="width: 60px; height: 60px; object-fit: cover;" alt="Image for {{ latest_post.title }}">
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1 lh-base">
                            <a href="{% url 'detail_post' latest_post.id %}" class="text-reset">{{ latest_post.title }}</a>
                            </h6>
                            <p class="text-muted fs-12 mb-0">
                            {{ latest_post.created_at|date:"M d, Y" }}
                                <i class="mdi mdi-circle-medium align-middle mx-1"></i>
                            {{ latest_post.created_at|date:"h:i A" }}
                            </p>
                        </div>
                    </div>
                    {% endfor %}

                    <div class="mt-3 text-center">
                        <a class="text-muted text-decoration-underline">View all News</a>
                    </div>

                </div><!-- end card body -->
            </div>
            <!--end card-->
            <div class="card">
                <div class="card-header align-items-center d-flex">
                    <h4 class="card-title mb-0 flex-grow-1">Related Post</h4>
                    <div>
                        <button type="button" class="btn btn-soft-primary btn-sm">
                            View all
                        </button>
                    </div>
                </div><!-- end card-header -->

                <div class="card-body">
                    {% for related_post in related_posts %}
                    <div class="d-flex mt-4">
                        <div class="flex-shrink-0">
                            <img src="{{ related_post.image.url }}" class="rounded img-fluid" style="width: 60px; height: 60px; object-fit: cover;" alt="Image for {{ related_post.title }}">
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1 lh-base">
                            <a href="{% url 'detail_post' related_post.id %}" class="text-reset">{{ related_post.title }}</a>
                            </h6>
                            <p class="text-muted fs-12 mb-0">
                            {{ related_post.created_at|date:"M d, Y" }}
                                <i class="mdi mdi-circle-medium align-middle mx-1"></i>
                            {{ related_post.created_at|date:"h:i A" }}
                            </p>
                        </div>
                    </div>
                    {% endfor %}

                    <div class="mt-3 text-center">
                        <a class="text-muted text-decoration-underline">View all News</a>
                    </div>

                </div><!-- end card body -->
            </div>
            <!--end card-->
        </div>
        <!--end col-->
    </div>
</div>
<!-- Card body -->

<!-- Button to view on map -->
</div>
<article>
    <p><a href="{% url 'list_post' %}">Quay lại danh sách bài viết</a></p>
</article>
{% endblock %}